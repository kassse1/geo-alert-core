# üö® Geo Alert Core

**Geo Alert Core** ‚Äî backend-—Å–µ—Ä–≤–∏—Å –Ω–∞ Go, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã –≥–µ–æ–æ–ø–æ–≤–µ—â–µ–Ω–∏–π.  
–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –æ–ø–∞—Å–Ω—ã—Ö –∑–æ–Ω –∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —É–≥—Ä–æ–∑ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ–±—Ö—É–∫–∏** –≤–æ –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ–≤–æ—Å—Ç–Ω–æ–π —Å–µ—Ä–≤–∏—Å –Ω–∞ Django).

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Clean Architecture** –∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ production-–ø–æ–¥—Ö–æ–¥.

---

## üìå –û–±—â–∞—è –∏–¥–µ—è —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- üì± **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**  
  –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

- üß† **Geo Alert Core (–¥–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å)**  
  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –∑–æ–Ω –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏

- üåê **–í–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç–∞–ª (Django)**  
  –ü–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **Clean Architecture**:

HTTP Handler

‚Üì

Service (Business Logic)

‚Üì

Repository (PostgreSQL)

### –°–ª–æ–∏ —Å–∏—Å—Ç–µ–º—ã

- **Handler** ‚Äî HTTP-—É—Ä–æ–≤–µ–Ω—å, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
- **Service** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–≥–µ–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –≤–µ–±—Ö—É–∫–∏)  
- **Repository** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL  
- **Middleware** ‚Äî API-key –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
- **Config** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ environment variables  
- **Transport** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è HTTP-—Å–µ—Ä–≤–µ—Ä–∞  

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1Ô∏è‚É£ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏  
CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ API-–∫–ª—é—á–æ–º.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|----------|
| POST | `/api/v1/incidents` | –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ |
| GET | `/api/v1/incidents` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è) |
| GET | `/api/v1/incidents/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID |
| PUT | `/api/v1/incidents/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| DELETE | `/api/v1/incidents/{id}` | –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è (soft delete) |

üîê –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key`.

---

### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–ø—É–±–ª–∏—á–Ω—ã–π API)

**POST** `/api/v1/location/check`

–ü–æ–≤–µ–¥–µ–Ω–∏–µ:
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–∞—Å–Ω—ã—Ö –∑–æ–Ω –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏
- –§–∞–∫—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —É–≥—Ä–æ–∑ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–µ–±—Ö—É–∫**

---

### 3Ô∏è‚É£ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**GET** `/api/v1/incidents/stats?minutes=N`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ `N` –º–∏–Ω—É—Ç.

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

{
  "user_count": 3
}

4Ô∏è‚É£ Health Check

GET /api/v1/system/health

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞.

üîî –í–µ–±—Ö—É–∫–∏

–û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

–ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π HTTP-–æ—Ç–≤–µ—Ç

URL –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ WEBHOOK_URL

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTP-—Å–µ—Ä–≤–µ—Ä-–∑–∞–≥–ª—É—à–∫–∞ –Ω–∞ :9090

üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

Go 1.24+

PostgreSQL 15

Docker / Docker Compose

REST API

Clean Architecture

Haversine formula (–≥–µ–æ-—Ä–∞—Å—á—ë—Ç—ã)

‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)
APP_PORT=8080
POSTGRES_DSN=postgres://danger:danger@localhost:5433/danger?sslmode=disable
API_KEY=super-secret-key
STATS_TIME_WINDOW_MINUTES=5
WEBHOOK_URL=http://localhost:9090/webhook

‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1Ô∏è‚É£ –ó–∞–ø—É—Å–∫ PostgreSQL
docker compose up -d

2Ô∏è‚É£ –ó–∞–ø—É—Å–∫ webhook-–∑–∞–≥–ª—É—à–∫–∏
go run ./cmd/webhook-mock

3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ API
go run ./cmd/api/main.go

üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (PowerShell)
–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
Invoke-RestMethod `
  -Uri "http://localhost:8080/api/v1/incidents" `
  -Method Post `
  -Headers @{ "X-API-Key" = "super-secret-key" } `
  -ContentType "application/json" `
  -Body (@{
    title = "Fire near mall"
    lat = 43.23
    lon = 76.88
    radius_m = 500
  } | ConvertTo-Json)

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
Invoke-RestMethod `
  -Uri "http://localhost:8080/api/v1/location/check" `
  -Method Post `
  -ContentType "application/json" `
  -Body (@{
    user_id = "user1"
    lat = 43.23
    lon = 76.88
  } | ConvertTo-Json)

üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤ (End-to-End)

–ó–∞–ø—É—Å—Ç–∏ webhook-mock

–°–æ–∑–¥–∞–π –∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç

–í—ã–ø–æ–ª–Ω–∏ location/check —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ —Ä—è–¥–æ–º —Å –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–º

–í –∫–æ–Ω—Å–æ–ª–∏ webhook-—Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤—Ö–æ–¥—è—â–∏–π JSON
